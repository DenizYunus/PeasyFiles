; PeasyFiles Installer Script
[Setup]
AppName=PeasyFiles
AppVersion=1.0
DefaultDirName={pf}\PeasyFiles
DefaultGroupName=PeasyFiles
OutputDir=.
OutputBaseFilename=PeasyFilesInstaller
Compression=lzma
SolidCompression=yes
PrivilegesRequired=admin
DisableProgramGroupPage=yes
DisableReadyPage=yes

[Files]
; Main executable
Source: "Path\To\Your\Executable\PeasyFiles.exe"; DestDir: "{app}"; Flags: ignoreversion
; Include all necessary DLLs
Source: "Path\To\Your\DLLs\*.dll"; DestDir: "{app}"; Flags: ignoreversion

[Icons]
Name: "{group}\PeasyFiles"; Filename: "{app}\PeasyFiles.exe"
Name: "{user}\PeasyFiles"; Filename: "{app}\PeasyFiles.exe"; Tasks: desktopicon

[Registry]
; Add to the Run key to start the application on Windows startup
Root: HKCU; Subkey: "Software\Microsoft\Windows\CurrentVersion\Run"; ValueType: string; ValueName: "PeasyFiles"; ValueData: """{app}\PeasyFiles.exe"""; Flags: uninsdeletevalue

[Run]
; Run the application after installation
Filename: "{app}\PeasyFiles.exe"; Description: "Launch PeasyFiles"; Flags: nowait postinstall skipifsilent